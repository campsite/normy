!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@normy/core"),require("react")):"function"==typeof define&&define.amd?define(["@normy/core","react"],t):"object"==typeof exports?exports.NormyReactQuery=t(require("@normy/core"),require("react")):e.NormyReactQuery=t(e.Normy,e.React)}(self,((e,t)=>(()=>{"use strict";var r={700:t=>{t.exports=e},359:e=>{e.exports=t}},o={};function n(e){var t=o[e];if(void 0!==t)return t.exports;var a=o[e]={exports:{}};return r[e](a,a.exports,n),a.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};return(()=>{n.r(a),n.d(a,{QueryNormalizerProvider:()=>i,createQueryNormalizer:()=>r,getId:()=>e.getId,useQueryNormalizer:()=>c});var e=n(700),t=function(e,t){return void 0===t?e:t},r=function(r,o){var n;void 0===o&&(o={});var a=null==(n=o.normalize)||n,u=(0,e.createNormalizer)(o),i=null,c=null,l=function(e,t,r){t.getQueriesToUpdate(e).forEach((function(e){r.setQueryData(JSON.parse(e.queryKey),(function(){return e.data}))}))};return{getNormalizedData:u.getNormalizedData,setNormalizedData:function(e){return l(e,u,r)},clear:u.clearNormalizedData,subscribe:function(){i=r.getQueryCache().subscribe((function(e){var o;"removed"===e.type?u.removeQuery(JSON.stringify(e.query.queryKey)):"updated"===e.type&&"success"===e.action.type&&void 0!==e.action.data&&t(a,null==(o=e.query.meta)?void 0:o.normalize)&&(l(e.action.data,u,r),u.setQuery(JSON.stringify(e.query.queryKey),e.action.data))})),c=r.getMutationCache().subscribe((function(e){var o,n,i;"updated"===e.type&&"success"===e.action.type&&e.action.data&&t(a,null==(o=e.mutation.meta)?void 0:o.normalize)?l(e.action.data,u,r):"updated"===e.type&&"pending"===e.action.type&&null!=(n=e.mutation.state)&&null!=(n=n.context)&&n.optimisticData?l(e.mutation.state.context.optimisticData,u,r):"updated"===e.type&&"error"===e.action.type&&null!=(i=e.mutation.state)&&null!=(i=i.context)&&i.rollbackData&&l(e.mutation.state.context.rollbackData,u,r)}))},unsubscribe:function(){null==i||i(),null==c||c(),i=null,c=null},getObjectById:u.getObjectById,getQueryFragment:u.getQueryFragment}},o=n(359),u=o.createContext(void 0),i=function(e){var t=e.queryClient,n=e.normalizerConfig,a=e.children,i=o.useState((function(){return r(t,n)}))[0];return o.useEffect((function(){return i.subscribe(),function(){i.unsubscribe(),i.clear()}}),[]),o.createElement(u.Provider,{value:i},a)},c=function(){var e=o.useContext(u);if(!e)throw new Error("No QueryNormalizer set, use QueryNormalizerProvider to set one");return e}})(),a})()));
//# sourceMappingURL=normy-react-query.min.js.map