!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.Normy=r():e.Normy=r()}(self,(()=>(()=>{"use strict";var e={619:e=>{var r=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var r=Object.prototype.toString.call(e);return"[object RegExp]"===r||"[object Date]"===r||function(e){return e.$$typeof===t}(e)}(e)},t="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function n(e,r){return!1!==r.clone&&r.isMergeableObject(e)?u((t=e,Array.isArray(t)?[]:{}),e,r):e;var t}function o(e,r,t){return e.concat(r).map((function(e){return n(e,t)}))}function i(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(r){return e.propertyIsEnumerable(r)})):[]}(e))}function u(e,t,c){(c=c||{}).arrayMerge=c.arrayMerge||o,c.isMergeableObject=c.isMergeableObject||r;var a=Array.isArray(t);return a===Array.isArray(e)?a?c.arrayMerge(e,t,c):function(e,r,t){var o={};return t.isMergeableObject(e)&&i(e).forEach((function(r){o[r]=n(e[r],t)})),i(r).forEach((function(i){t.isMergeableObject(r[i])&&e[i]?o[i]=function(e,r){if(!r.customMerge)return u;var t=r.customMerge(e);return"function"==typeof t?t:u}(i,t)(e[i],r[i],t):o[i]=n(r[i],t)})),o}(e,t,c):n(t,c)}u.all=function(e,r){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,t){return u(e,t,r)}),{})};var c=u;e.exports=c}},r={};function t(n){var o=r[n];if(void 0!==o)return o.exports;var i=r[n]={exports:{}};return e[n](i,i.exports,t),i.exports}t.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return t.d(r,{a:r}),r},t.d=(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return(()=>{function e(){return e=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},e.apply(this,arguments)}t.r(n),t.d(n,{createNormalizer:()=>y,getId:()=>b});var r={getNormalizationObjectKey:function(e){return e.id},devLogging:!1,structuralSharing:!0},o=t(619),i=t.n(o),u=function(e,r){return i()(e,r,{arrayMerge:function(e,r){return r},clone:!1})},c=function e(r,t,n){if(void 0===n&&(n=!0),Array.isArray(r))return r.map((function(r){return e(r,t)}));if(null!==r&&"object"==typeof r&&!(r instanceof Date)){var o=t.getNormalizationObjectKey(r);return void 0!==o&&n?"@@"+o:Object.entries(r).reduce((function(r,n){var o=n[0],i=n[1];return r[o]=e(i,t),r}),{})}return r},a=function e(t,n,o,i){return void 0===n&&(n=r),void 0===i&&(i=""),o=o||{},Array.isArray(t)?[t.reduce((function(r,t){return[].concat(r,e(t,n,o,i)[0])}),[]),o]:null===t||"object"!=typeof t||t instanceof Date?[[],o]:(void 0!==n.getNormalizationObjectKey(t)&&(o[i]=Object.keys(t)),[Object.entries(t).reduce((function(r,t){var u=t[0],c=t[1];return[].concat(r,e(c,n,o,i+"."+u)[0])}),void 0!==n.getNormalizationObjectKey(t)?[t]:[]),o])},f=function(e,t){void 0===t&&(t=r);var n=a(e,t),o=n[0],i=n[1];return[c(e,t,!0),o.reduce((function(e,r){var n=t.getNormalizationObjectKey(r);return e["@@"+n]=e["@@"+n]?u(e["@@"+n],c(r,t,!1)):c(r,t,!1),e}),{}),i]},s=function e(r,t,n,o){return void 0===o&&(o=""),"string"==typeof r&&r.startsWith("@@")?e(t[r],t,n,o):Array.isArray(r)?r.map((function(r){return e(r,t,n,o)})):null===r||"object"!=typeof r||r instanceof Date?r:(n[o]?Object.entries(r).filter((function(e){var r=e[0];return n[o].includes(r)})):Object.entries(r)).reduce((function(r,i){var u=i[0],c=i[1];return r[u]=e(c,t,n,o+"."+u),r}),{})},d={queries:{},objects:{},dependentQueries:{}},l=function e(r,t){return Array.isArray(r)&&Array.isArray(t)?0===r.length?0!==t.length:r.some((function(r,n){return e(r,t[n])})):r instanceof Date&&t instanceof Date?r.getTime()!==t.getTime():null!==r&&"object"==typeof r&&null!==t&&"object"==typeof t?Object.entries(r).some((function(r){var n=r[0],o=r[1];return void 0!==(null==t?void 0:t[n])&&e(o,t[n])})):r!==t},y=function(t,n){var o=e({},r,t),i=null!=n?n:d,c={},a=function(r,t){var n;if(o.structuralSharing){if(c[r]===t)return;c[r]=t}var a,s,d=f(t,o),l=d[0],y=d[1],b=d[2],p=(a=i.queries[r]?i.queries[r].dependencies:[],{addedDependencies:(s=Object.keys(y)).filter((function(e){return!a.includes(e)})),removedDependencies:a.filter((function(e){return!s.includes(e)}))}),g=p.addedDependencies,v=p.removedDependencies;i=e({queries:e({},i.queries,(n={},n[r]={data:l,usedKeys:b,dependencies:Object.keys(y)},n))},function(r,t,n,o,i){return r=e({},r),t=e({},t),o.forEach((function(e){r[e]||(r[e]=[n]),r[e].includes(n)||(r[e]=[].concat(r[e],[n]))})),i.forEach((function(e){r[e].length>1?r[e]=r[e].filter((function(e){return e!==n})):(delete r[e],delete t[e])})),{dependentQueries:r,objects:t}}(i.dependentQueries,u(i.objects,y),r,g,v)),o.devLogging},y=function(e,r){var t={};r&&(t=f(r,o)[2]);try{return s(e,i.objects,t)}catch(e){if(e instanceof RangeError)return;throw e}};return{getNormalizedData:function(){return i},clearNormalizedData:function(){i=d,c={}},setQuery:a,removeQuery:function(r){a(r,null);var t=e({},i.queries);delete t[r],delete c[r],i=e({},i,{queries:t}),o.devLogging},getQueriesToUpdate:function(e){var r,t,n,c=function(e,r){var t={};for(var n in e)l(e[n],r[n])&&(t[n]=e[n]);return t}(f(e,o)[1],i.objects),a=u(i.objects,c);return(r=i.dependentQueries,t=Object.keys(c),n=[],t.forEach((function(e){r[e]&&n.push.apply(n,r[e])})),Array.from(new Set(n))).map((function(e){return{queryKey:e,data:s(i.queries[e].data,a,i.queries[e].usedKeys)}}))},getObjectById:function(e,r){return y("@@"+e,r)},getQueryFragment:y}},b=function(e){return"@@"+e}})(),n})()));
//# sourceMappingURL=normy.min.js.map